<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PHP（客户端）与 Golang（服务端）使用grpc+protobuf 通信 | 云海的博客</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="服务端技术博客,包括PHP,GoLang,MySQL,Docker,Redis,微服务等技术文章。">
    <meta name="keywords" content="服务端技术博客,PHP,GoLang,MySQL,Docker,Redis,微服务">
    <meta name="baidu-site-verification" content="code-29NGq3DxKH">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.44f6a52f.css" as="style"><link rel="preload" href="/assets/js/app.a8ee54a5.js" as="script"><link rel="preload" href="/assets/js/2.9746fdea.js" as="script"><link rel="preload" href="/assets/js/38.7db1000c.js" as="script"><link rel="prefetch" href="/assets/js/10.b2ad049a.js"><link rel="prefetch" href="/assets/js/11.bb87e5f2.js"><link rel="prefetch" href="/assets/js/12.0b4d7474.js"><link rel="prefetch" href="/assets/js/13.4269b487.js"><link rel="prefetch" href="/assets/js/14.53985f4b.js"><link rel="prefetch" href="/assets/js/15.fced7044.js"><link rel="prefetch" href="/assets/js/16.b154c63f.js"><link rel="prefetch" href="/assets/js/17.d940ba8a.js"><link rel="prefetch" href="/assets/js/18.e4c4ed76.js"><link rel="prefetch" href="/assets/js/19.079ef70b.js"><link rel="prefetch" href="/assets/js/20.56fa7610.js"><link rel="prefetch" href="/assets/js/21.c799fe30.js"><link rel="prefetch" href="/assets/js/22.ae2308f4.js"><link rel="prefetch" href="/assets/js/23.18407da3.js"><link rel="prefetch" href="/assets/js/24.5ebac264.js"><link rel="prefetch" href="/assets/js/25.8039c4c9.js"><link rel="prefetch" href="/assets/js/26.aefd35fc.js"><link rel="prefetch" href="/assets/js/27.fd9e235e.js"><link rel="prefetch" href="/assets/js/28.6e9a638d.js"><link rel="prefetch" href="/assets/js/29.3a21e0fa.js"><link rel="prefetch" href="/assets/js/3.67197aa6.js"><link rel="prefetch" href="/assets/js/30.44e86ea1.js"><link rel="prefetch" href="/assets/js/31.88490486.js"><link rel="prefetch" href="/assets/js/32.c56b28c6.js"><link rel="prefetch" href="/assets/js/33.f4ab3c6c.js"><link rel="prefetch" href="/assets/js/34.992dddcf.js"><link rel="prefetch" href="/assets/js/35.41a72c34.js"><link rel="prefetch" href="/assets/js/36.105fb962.js"><link rel="prefetch" href="/assets/js/37.7d86b3d7.js"><link rel="prefetch" href="/assets/js/39.bac46fcf.js"><link rel="prefetch" href="/assets/js/4.7dc4d1dc.js"><link rel="prefetch" href="/assets/js/40.d92ad0f2.js"><link rel="prefetch" href="/assets/js/41.b7e4d518.js"><link rel="prefetch" href="/assets/js/42.dc3905e2.js"><link rel="prefetch" href="/assets/js/43.e08369a8.js"><link rel="prefetch" href="/assets/js/44.79ec59e8.js"><link rel="prefetch" href="/assets/js/45.5a762d76.js"><link rel="prefetch" href="/assets/js/46.4101344d.js"><link rel="prefetch" href="/assets/js/47.08593b08.js"><link rel="prefetch" href="/assets/js/48.322b76ca.js"><link rel="prefetch" href="/assets/js/49.1e7b56d4.js"><link rel="prefetch" href="/assets/js/5.d7df19fe.js"><link rel="prefetch" href="/assets/js/50.f3f8e382.js"><link rel="prefetch" href="/assets/js/51.eba15507.js"><link rel="prefetch" href="/assets/js/52.6aa0d502.js"><link rel="prefetch" href="/assets/js/53.98f883fd.js"><link rel="prefetch" href="/assets/js/54.43265d8a.js"><link rel="prefetch" href="/assets/js/55.3bd71f1b.js"><link rel="prefetch" href="/assets/js/56.3e8e3285.js"><link rel="prefetch" href="/assets/js/57.80b20728.js"><link rel="prefetch" href="/assets/js/58.c410034c.js"><link rel="prefetch" href="/assets/js/59.f6d1e63a.js"><link rel="prefetch" href="/assets/js/6.387ccb4c.js"><link rel="prefetch" href="/assets/js/60.3a92eb9c.js"><link rel="prefetch" href="/assets/js/61.6a3f74ce.js"><link rel="prefetch" href="/assets/js/62.b64ff107.js"><link rel="prefetch" href="/assets/js/63.5fa20907.js"><link rel="prefetch" href="/assets/js/64.72941b6b.js"><link rel="prefetch" href="/assets/js/65.d6523677.js"><link rel="prefetch" href="/assets/js/66.0d4e244f.js"><link rel="prefetch" href="/assets/js/67.641d47be.js"><link rel="prefetch" href="/assets/js/68.75b321a8.js"><link rel="prefetch" href="/assets/js/69.c65b174a.js"><link rel="prefetch" href="/assets/js/7.0ffa4dd1.js"><link rel="prefetch" href="/assets/js/70.95ca024f.js"><link rel="prefetch" href="/assets/js/71.e4cc221f.js"><link rel="prefetch" href="/assets/js/72.0fe6c5ae.js"><link rel="prefetch" href="/assets/js/73.97ff0bc5.js"><link rel="prefetch" href="/assets/js/74.0fbf4cb3.js"><link rel="prefetch" href="/assets/js/75.58038c79.js"><link rel="prefetch" href="/assets/js/8.843b1848.js"><link rel="prefetch" href="/assets/js/9.95e17cbd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.44f6a52f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">云海的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Golang" class="dropdown-title"><a href="/pages/8f03ad02c6cad600d2c00a972a9bcce6/" class="link-title">Golang</a> <span class="title" style="display:none;">Golang</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8f03ad02c6cad600d2c00a972a9bcce6/" class="nav-link">接口</a></li><li class="dropdown-item"><!----> <a href="/pages/457fbb/" class="nav-link">数组</a></li><li class="dropdown-item"><!----> <a href="/pages/5c76b5/" class="nav-link">slice</a></li><li class="dropdown-item"><!----> <a href="/pages/8fc4c7ab4453d247e011738197b6136c/" class="nav-link">map</a></li><li class="dropdown-item"><!----> <a href="/pages/1c2657/" class="nav-link">指针</a></li><li class="dropdown-item"><!----> <a href="/pages/6169b9/" class="nav-link">反射</a></li><li class="dropdown-item"><!----> <a href="/pages/14d426/" class="nav-link">Context</a></li><li class="dropdown-item"><!----> <a href="/pages/95151a/" class="nav-link">sync.map</a></li><li class="dropdown-item"><!----> <a href="/pages/89b18e/" class="nav-link">锁</a></li><li class="dropdown-item"><!----> <a href="/pages/1d6684/" class="nav-link">类型和类型指针分析</a></li><li class="dropdown-item"><!----> <a href="/pages/4ee2bd/" class="nav-link">recover</a></li><li class="dropdown-item"><!----> <a href="/pages/80423c/" class="nav-link">从零实现RPC框架</a></li><li class="dropdown-item"><!----> <a href="/pages/3de6c3/" class="nav-link">make和new区别</a></li><li class="dropdown-item"><!----> <a href="/pages/56325e/" class="nav-link">channel</a></li><li class="dropdown-item"><!----> <a href="/pages/6bf5a8/" class="nav-link">sync.Once</a></li><li class="dropdown-item"><!----> <a href="/pages/0a6c0b/" class="nav-link">sync.Pool</a></li><li class="dropdown-item"><!----> <a href="/pages/d735a5/" class="nav-link">protobuf</a></li><li class="dropdown-item"><!----> <a href="/pages/80fc75/" class="nav-link">MongoDB pkg源码-findone</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JAVA" class="dropdown-title"><a href="/pages/73a4e2/" class="link-title">JAVA</a> <span class="title" style="display:none;">JAVA</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/73a4e2/" class="nav-link">MyBatis</a></li><li class="dropdown-item"><!----> <a href="/pages/329c9c/" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PHP" class="dropdown-title"><a href="/pages/8309a5b876fc95e3123/" class="link-title">PHP</a> <span class="title" style="display:none;">PHP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3123/" class="nav-link">解析Laravel框架—路由处理</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Grpc" class="dropdown-title"><a href="/pages/8309a5b876f/" aria-current="page" class="link-title router-link-exact-active router-link-active">Grpc</a> <span class="title" style="display:none;">Grpc</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876f/" aria-current="page" class="nav-link router-link-exact-active router-link-active">PHP（客户端）与 Golang（服务端）使用grpc+protobuf 通信</a></li><li class="dropdown-item"><!----> <a href="/pages/bc0c03/" class="nav-link">JAVA（客户端）与 Golang（服务端） 使用grpc+protobuf通信</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><a href="/pages/8309a5b876fc95e3124/" class="link-title">微服务</a> <span class="title" style="display:none;">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3124/" class="nav-link">Docker使用笔记-常用命令</a></li><li class="dropdown-item"><!----> <a href="/pages/5352bd/" class="nav-link">Docker使用笔记-容器间通讯</a></li><li class="dropdown-item"><!----> <a href="/pages/22971e/" class="nav-link">Docker使用笔记-搭建Redis集群</a></li><li class="dropdown-item"><!----> <a href="/pages/425b20/" class="nav-link">Docker使用笔记-镜像多阶段构建</a></li><li class="dropdown-item"><!----> <a href="/pages/c3645d/" class="nav-link">Kubernetes部署golang服务</a></li><li class="dropdown-item"><!----> <a href="/pages/3e8bf0/" class="nav-link">Linux常用命令</a></li><li class="dropdown-item"><!----> <a href="/pages/4ada6d/" class="nav-link">Docker安装Prometheus与Grafana</a></li><li class="dropdown-item"><!----> <a href="/pages/e24bcf/" class="nav-link">Protobuf</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><a href="/pages/6e85db/" class="link-title">网络</a> <span class="title" style="display:none;">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/6e85db/" class="nav-link">TCP抓包</a></li><li class="dropdown-item"><!----> <a href="/pages/d9d328/" class="nav-link">概述-《TCP/IP详解》读书笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><a href="/pages/4fd1b2/" class="link-title">MySQL</a> <span class="title" style="display:none;">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4fd1b2/" class="nav-link">索引</a></li><li class="dropdown-item"><!----> <a href="/pages/b8ed02/" class="nav-link">事务隔离级别</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Redis" class="dropdown-title"><a href="/pages/d31321/" class="link-title">Redis</a> <span class="title" style="display:none;">Redis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/d31321/" class="nav-link">常识</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="每日一题(1)" class="dropdown-title"><a href="/pages/87ebf8/" class="link-title">每日一题(1)</a> <span class="title" style="display:none;">每日一题(1)</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/87ebf8/" class="nav-link">每日一题(1)</a></li><li class="dropdown-item"><!----> <a href="/pages/d238dd/" class="nav-link">每日一题(2)</a></li><li class="dropdown-item"><!----> <a href="/pages/339b1b/" class="nav-link">每日一题(3)</a></li><li class="dropdown-item"><!----> <a href="/pages/e163f1/" class="nav-link">每日一题(4)</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/study825" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatars.githubusercontent.com/u/25599512?s=400&amp;u=3ead57ca8c8216c389694364377b10f011dee419&amp;v=4"> <div class="blogger-info"><h3>云海</h3> <span>服务端研发</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Golang" class="dropdown-title"><a href="/pages/8f03ad02c6cad600d2c00a972a9bcce6/" class="link-title">Golang</a> <span class="title" style="display:none;">Golang</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8f03ad02c6cad600d2c00a972a9bcce6/" class="nav-link">接口</a></li><li class="dropdown-item"><!----> <a href="/pages/457fbb/" class="nav-link">数组</a></li><li class="dropdown-item"><!----> <a href="/pages/5c76b5/" class="nav-link">slice</a></li><li class="dropdown-item"><!----> <a href="/pages/8fc4c7ab4453d247e011738197b6136c/" class="nav-link">map</a></li><li class="dropdown-item"><!----> <a href="/pages/1c2657/" class="nav-link">指针</a></li><li class="dropdown-item"><!----> <a href="/pages/6169b9/" class="nav-link">反射</a></li><li class="dropdown-item"><!----> <a href="/pages/14d426/" class="nav-link">Context</a></li><li class="dropdown-item"><!----> <a href="/pages/95151a/" class="nav-link">sync.map</a></li><li class="dropdown-item"><!----> <a href="/pages/89b18e/" class="nav-link">锁</a></li><li class="dropdown-item"><!----> <a href="/pages/1d6684/" class="nav-link">类型和类型指针分析</a></li><li class="dropdown-item"><!----> <a href="/pages/4ee2bd/" class="nav-link">recover</a></li><li class="dropdown-item"><!----> <a href="/pages/80423c/" class="nav-link">从零实现RPC框架</a></li><li class="dropdown-item"><!----> <a href="/pages/3de6c3/" class="nav-link">make和new区别</a></li><li class="dropdown-item"><!----> <a href="/pages/56325e/" class="nav-link">channel</a></li><li class="dropdown-item"><!----> <a href="/pages/6bf5a8/" class="nav-link">sync.Once</a></li><li class="dropdown-item"><!----> <a href="/pages/0a6c0b/" class="nav-link">sync.Pool</a></li><li class="dropdown-item"><!----> <a href="/pages/d735a5/" class="nav-link">protobuf</a></li><li class="dropdown-item"><!----> <a href="/pages/80fc75/" class="nav-link">MongoDB pkg源码-findone</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JAVA" class="dropdown-title"><a href="/pages/73a4e2/" class="link-title">JAVA</a> <span class="title" style="display:none;">JAVA</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/73a4e2/" class="nav-link">MyBatis</a></li><li class="dropdown-item"><!----> <a href="/pages/329c9c/" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="PHP" class="dropdown-title"><a href="/pages/8309a5b876fc95e3123/" class="link-title">PHP</a> <span class="title" style="display:none;">PHP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3123/" class="nav-link">解析Laravel框架—路由处理</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Grpc" class="dropdown-title"><a href="/pages/8309a5b876f/" aria-current="page" class="link-title router-link-exact-active router-link-active">Grpc</a> <span class="title" style="display:none;">Grpc</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876f/" aria-current="page" class="nav-link router-link-exact-active router-link-active">PHP（客户端）与 Golang（服务端）使用grpc+protobuf 通信</a></li><li class="dropdown-item"><!----> <a href="/pages/bc0c03/" class="nav-link">JAVA（客户端）与 Golang（服务端） 使用grpc+protobuf通信</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><a href="/pages/8309a5b876fc95e3124/" class="link-title">微服务</a> <span class="title" style="display:none;">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8309a5b876fc95e3124/" class="nav-link">Docker使用笔记-常用命令</a></li><li class="dropdown-item"><!----> <a href="/pages/5352bd/" class="nav-link">Docker使用笔记-容器间通讯</a></li><li class="dropdown-item"><!----> <a href="/pages/22971e/" class="nav-link">Docker使用笔记-搭建Redis集群</a></li><li class="dropdown-item"><!----> <a href="/pages/425b20/" class="nav-link">Docker使用笔记-镜像多阶段构建</a></li><li class="dropdown-item"><!----> <a href="/pages/c3645d/" class="nav-link">Kubernetes部署golang服务</a></li><li class="dropdown-item"><!----> <a href="/pages/3e8bf0/" class="nav-link">Linux常用命令</a></li><li class="dropdown-item"><!----> <a href="/pages/4ada6d/" class="nav-link">Docker安装Prometheus与Grafana</a></li><li class="dropdown-item"><!----> <a href="/pages/e24bcf/" class="nav-link">Protobuf</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><a href="/pages/6e85db/" class="link-title">网络</a> <span class="title" style="display:none;">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/6e85db/" class="nav-link">TCP抓包</a></li><li class="dropdown-item"><!----> <a href="/pages/d9d328/" class="nav-link">概述-《TCP/IP详解》读书笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MySQL" class="dropdown-title"><a href="/pages/4fd1b2/" class="link-title">MySQL</a> <span class="title" style="display:none;">MySQL</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4fd1b2/" class="nav-link">索引</a></li><li class="dropdown-item"><!----> <a href="/pages/b8ed02/" class="nav-link">事务隔离级别</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Redis" class="dropdown-title"><a href="/pages/d31321/" class="link-title">Redis</a> <span class="title" style="display:none;">Redis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/d31321/" class="nav-link">常识</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="每日一题(1)" class="dropdown-title"><a href="/pages/87ebf8/" class="link-title">每日一题(1)</a> <span class="title" style="display:none;">每日一题(1)</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/87ebf8/" class="nav-link">每日一题(1)</a></li><li class="dropdown-item"><!----> <a href="/pages/d238dd/" class="nav-link">每日一题(2)</a></li><li class="dropdown-item"><!----> <a href="/pages/339b1b/" class="nav-link">每日一题(3)</a></li><li class="dropdown-item"><!----> <a href="/pages/e163f1/" class="nav-link">每日一题(4)</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/study825" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/b416bd/" class="sidebar-link">基础</a></li><li><a href="/pages/5f495f/" class="sidebar-link">gRPC拦截器</a></li><li><a href="/pages/8309a5b876f/" aria-current="page" class="active sidebar-link">PHP（客户端）与 Golang（服务端）使用grpc+protobuf 通信</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/bc0c03/" class="sidebar-link">JAVA（客户端）与 Golang（服务端） 使用grpc+protobuf通信</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=gRPC%E7%B3%BB%E5%88%97" title="分类" data-v-1baff76c>gRPC系列</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://github.com/study825" target="_blank" title="作者" class="beLink" data-v-1baff76c>云海</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2021-03-29</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">PHP（客户端）与 Golang（服务端）使用grpc+protobuf 通信<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <p>从零开始讲解，PHP（客户端）与 Golang（服务端）使用grpc+protobuf 通信。因为我本地环境都是配置好的，避免我落下步骤操作，所以我在docker环境下开发，拉取一个基于Alpine的镜像。Alpine操作系统是一个面向安全的轻型 Linux 发行版。</p> <h3 id="正文"><a href="#正文" class="header-anchor">#</a> 正文</h3> <p>搭建环境</p> <p>1.项目中，我会用到composer以及PHP相关的扩展，于是我拉取一个基于PHP7.2的docker镜像。命令中的参数，可以看我另一篇文章，Docker 使用笔记-常用基础命令。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker container run -it --name grpc-ubuntu -v /Users/wuerzhilv-lq/examples:/home/examples lorisleiva/laravel-docker:7.2 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.安装相关的包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apk add autoconf automake libtool linux-headers 　
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.这个docker没有golang语言环境，我们这里安装下。这里采用编译安装的方式，为什么不用apk包管理器安装，因为Go工具链是用Go编写的，要构建它，需要安装Go编译器；由于我们没有GO编译器，同时1.4以后的GO语言版本没有直接支持GCC，支持GO编译器和GCCGO，因此我们需要先现在1.
4版本的GO，利用GCC编译好GO编译器后，再利用1.4版本的GO编译器编译最新版本的GO（比如以下的1.14)。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>①下载go1.4版本，源码从官方下载
wget https://dl.google.com/go/go1.4-bootstrap-20171003.tar.gz
tar -zxf go1.4-bootstrap-20171003.tar.gz
mv go /usr/local/go1.4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>②下载go1.14版本
wget  https://dl.google.com/go/go1.14.2.src.tar.gz
tar -zxf go1.14.2.src.tar.gz
mv go /usr/local/go
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>③环境变量设置(GOROOT_BOOTSTRAP是编译器环境设定需要)
echo 'export GOROOT_BOOTSTRAP=/usr/local/go1.4' &gt;&gt; ~/.bash_profile
echo 'export GOROOT=/usr/local/go' &gt;&gt; ~/.bash_profile
echo 'export PATH=${GOROOT}/bin:${PATH}' &gt;&gt; ~/.bash_profile
//重载环境配置变量（主要是重载GOROOT_BOOTSTRAP）
source ~/.bash_profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>④ 编译go1.4的版本 
cd /usr/local/go1.4/src &amp;&amp; ./make.bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>⑤利用go1.4的go编译器，编译go1.14
cd /usr/local/go/src &amp;&amp; ./make.bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>⑥查看golang版本
go version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>4.新下载的php本来就没有现成的php.ini文件。只是给了php.ini-development （开发环境用）与 php.ini-production（生产环境用）两个建议。这里我们基于生产环境，复制出一个php.ini文件。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp /usr/local/etc/php/php.ini-production  /usr/local/etc/php/php.ini
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>5.系统层面的，我们环境就安装好了。Grpc 是使用protobuf来传输数据，protobuf是一个文件，那怎么让php和golang语言识别它，这里就需要一个编译工具了。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apk add protobuf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="6"><li>PHP安装Grpc,Protobuf扩展。</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>pecl install grpc-1.25.0
pecl install protobuf-3.11.4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>打开我们新建的php.ini文件，将扩展加进去。可以使用php -m 查看配置是否生效。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>extension=grpc.so    
extension=protobuf.so
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>7.安装PHP Protoc Plugin</p> <p>第一种方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ git clone -b v1.28.1 https://github.com/grpc/grpc
$ cd grpc
$ git submodule update --init
$ make grpc_php_plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>make编译后，输出目录为bins/opt,输出文件grpc_php_plugin,将文件复制到/home/examples</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp bins/opt/grpc_php_plugin  /home/examples/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第二种方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bazel build src/compiler:grpc_php_plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>8.安装Golang Protoc Plugin</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>go get -u github.com/golang/protobuf/protoc-gen-go
export PATH=$PATH:$GOPATH/bin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>9.安装grpc</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>go get -u google.golang.org/grpc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10.环境都配好了，我们来写项目代码，我在创建docker容器的时候，就把容器目录挂载到了本地，可以使用ide工具开发。</p> <p>我这里配置的本地目录是，/Users/wuerzhilv-lq/examples。examples就相当于项目目录了，在这个项目中新建protos目录，用于存放protobuf文件；新建php目录用于存放客户端代码；新建go目录，用于存放服务端代码。</p> <p>我们新建一个protobuf文件（helloworld.proto），来定义服务方法，请求参数，请求返回值。 内容如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 定义语法，一共是有两种proto2,proto3。我这里使用proto3。
syntax = &quot;proto3&quot;;

// 定义服务（我感觉像类）
service Greeter {
  // 定义服务方法为SayHello，可以有多个方法
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}

//定义请求参数
message HelloRequest {
  string name = 1;
}

//定义返回参数
message HelloReply {
   string message = 1;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ol start="11"><li>服务端代码，进入容器中的项目目录，根据protobuf文件，使用proto工具生成服务端（golang）代码到go目录。执行命令之后，会在go文件夹中出现一个proto文件夹,里面包含一个helloworld.pb.go文件。</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>protoc protos/helloworld.proto --go_out=plugins=grpc:go
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在examples/go 文件夹中，新建一个main.go文件，注册helloworld服务。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;context&quot;</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;net&quot;</span>

    <span class="token string">&quot;google.golang.org/grpc&quot;</span>
    pb <span class="token string">&quot;./protos&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
    port <span class="token operator">=</span> <span class="token string">&quot;:50051&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// server is used to implement helloworld.GreeterServer.</span>
<span class="token keyword">type</span> server <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    pb<span class="token punctuation">.</span>UnimplementedGreeterServer
<span class="token punctuation">}</span>

<span class="token comment">// SayHello implements helloworld.GreeterServer</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>server<span class="token punctuation">)</span> <span class="token function">SayHello</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> in <span class="token operator">*</span>pb<span class="token punctuation">.</span>HelloRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>pb<span class="token punctuation">.</span>HelloReply<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Received: %v&quot;</span><span class="token punctuation">,</span> in<span class="token punctuation">.</span><span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>pb<span class="token punctuation">.</span>HelloReply<span class="token punctuation">{</span>Message<span class="token punctuation">:</span> <span class="token string">&quot;Hello &quot;</span> <span class="token operator">+</span> in<span class="token punctuation">.</span><span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lis<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to listen: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    s <span class="token operator">:=</span> grpc<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    pb<span class="token punctuation">.</span><span class="token function">RegisterGreeterServer</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>server<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;服务启动&quot;</span><span class="token operator">+</span>port<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> s<span class="token punctuation">.</span><span class="token function">Serve</span><span class="token punctuation">(</span>lis<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to serve: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>运行go run main.go启动服务,看看服务是否能启动。</p> <p>12.客户端代码，进入容器中的项目目录，根据protobuf文件，使用proto工具生成客户端（PHP）代码到php目录。执行命令之后，会在php文件夹中出现一些文件。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>protoc --proto_path=protos   --php_out=php   --grpc_out=php   --plugin=protoc-gen-grpc=/home/examples/grpc_php_plugin protos/helloworld.proto
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>更换composer源</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过composer工具，我们初始化一个composer.json文件。</p> <p>composer.json内容如下：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
　　<span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;grpc/grpc-demo&quot;</span><span class="token punctuation">,</span>
　　<span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gRPC example for PHP&quot;</span><span class="token punctuation">,</span>
　　<span class="token property">&quot;require&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
　　　　<span class="token property">&quot;grpc/grpc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.27&quot;</span><span class="token punctuation">,</span>
　　　　<span class="token property">&quot;google/protobuf&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.11&quot;</span>
　　<span class="token punctuation">}</span><span class="token punctuation">,</span>
　　<span class="token property">&quot;authors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
　　　　<span class="token punctuation">{</span>
　　　　　　<span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Li&quot;</span><span class="token punctuation">,</span>
　　　　　　<span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;calmliqi@gmail.com&quot;</span>
　　　　<span class="token punctuation">}</span>
　　<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>composer install 安装扩展包。</p> <p>在php目录下，新建客户端文件，greeter_client.php</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">require</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/vendor/autoload.php'</span><span class="token punctuation">;</span>

@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/Helloworld/GreeterClient.php'</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/Helloworld/HelloReply.php'</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/Helloworld/HelloRequest.php'</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/GPBMetadata/Helloworld.php'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">greet</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Helloworld<span class="token punctuation">\</span>GreeterClient</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost:50051'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'credentials'</span> <span class="token operator">=&gt;</span> <span class="token class-name class-name-fully-qualified static-context">Grpc<span class="token punctuation">\</span>ChannelCredentials</span><span class="token operator">::</span><span class="token function">createInsecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Helloworld<span class="token punctuation">\</span>HelloRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">SayHello</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token variable">$message</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$name</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'world'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">;</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>13.进入examples项目目录,</p> <p>启动服务端</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>go run go/main.go
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行客户端</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>php php/greeter_client.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果输出helloworld，那就是成功了。</p> <h4 id="总结"><a href="#总结" class="header-anchor">#</a> 总结：</h4> <p>这篇文章，只是简单粗略说了下，Grpc+protobuf的使用，比如针对protobuf文件，具体的内容没有说。以后，我会在写一篇针对protobuf文件详细讲解的文章。我懂得也不是太多，就是当自己做了一次总结。如有不对的地方，大家多提意见。我本机挂了代理，所以没有遇到墙的问题，如果被墙了，自行百度吧。
参考了如下资料：</p> <p>https://developers.google.com/protocol-buffers</p> <p>https://grpc.io/docs/quickstart</p> <p>https://golang.org/doc/install/source</p> <p>https://tkstorm.com/posts-list/programming/go/build-golang-from-source-on-alpine/</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/06/05</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/5f495f/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">gRPC拦截器</div></a> <a href="/pages/bc0c03/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">JAVA（客户端）与 Golang（服务端） 使用grpc+protobuf通信</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/5f495f/" class="prev">gRPC拦截器</a></span> <span class="next"><a href="/pages/bc0c03/">JAVA（客户端）与 Golang（服务端） 使用grpc+protobuf通信</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/befead/"><div>
            函数
            <!----></div></a> <span class="date">04-11</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/b439dd/"><div>
            面试题
            <!----></div></a> <span class="date">04-11</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/faa800/"><div>
            EFK日志收集系统单机版
            <!----></div></a> <span class="date">08-18</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:calmli@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/study825" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2025
    <span>Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a8ee54a5.js" defer></script><script src="/assets/js/2.9746fdea.js" defer></script><script src="/assets/js/38.7db1000c.js" defer></script>
  </body>
</html>
